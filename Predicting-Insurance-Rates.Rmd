---
title: "Predicting-Insurance-Rates"
author: "Harsh Mishrikotkar"
date: "2025-05-19"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

### Importing Libraries and the Data Set

```{r libraryies and dataset}
# Installing Libraries
library(tidyverse)
library(gridExtra)
library(grid)
# Installing Data set
insuranceData <- read_csv("insurance.csv")
```
### Explanation of Variables and Summary of data set

+ **Age:** Age of primary beneficiary
+ **Sex:** Insurance contractor gender, female, male
+ **BMI:** Body mass index, providing an understanding of body, weights that are relatively high or low relative to height, objective index of body weight (kg / m ^ 2) using the ratio of height to weight
+ **Children:** Number of children covered by health insurance / Number of dependents
+ **Smoker:** Smoking
+ **Region** The beneficiary's residential area in the US, northeast, southeast, southwest, northwest
+ **Charges:** Individual medical costs billed by health insurance

```{r Viewing the data set and its summary}
summary(insuranceData)
```

```{r create histograms and bar charts, fig.width = 30, fig.height = 45}

create_all_histograms <- function(data, ncol = 2){
  if (nrow(data) == 0 || ncol(data) == 0){
    stop("Dataset is empty")
  }
  
  plot_list <- list()
  
  for (col_name in names(data)){
    current_col <- data[[col_name]]
    if (is.numeric(current_col)){
      p <- ggplot(data,
                  aes(x = .data[[col_name]])) +
        geom_histogram(fill = "steelblue",
                       color = "black",
                       bins = min(15, length(unique(current_col)))) +
        labs(title = paste("Histogram of", col_name),
             x = col_name,
             y = "Frequency") +
        theme_minimal() +
        theme(plot.title = element_text(size = 45, face = "bold"),
              axis.title = element_text(size = 30),
              axis.text = element_text(size = 30))
    }
    
    else {
      p <- ggplot(data,
                  aes(x = .data[[col_name]])) +
        geom_bar(fill = "slategray",
                 color = "black") +
        labs(title = paste("Distribution of", col_name),
             x = col_name,
             y = "Count") +
        theme_minimal() +
        theme(plot.title = element_text(size = 45, face = "bold"),
              axis.title = element_text(size = 30),
              axis.text = element_text(size = 30))
      if (length(unique(current_col)) > 5){
        p <- p + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 30))
      }
    }
    plot_list[[col_name]] <- p
  }
  grid.arrange(grobs = plot_list,
               ncol = ncol,
               top = textGrob("Histograms of All Variables", gp = gpar(fontsize = 55, fontface = "bold")))
}

create_all_histograms(insuranceData)
```

#### Based of the Histogram and Bar plots: 

* **Age**
    * has no distribution, with a slightly larger grouping at approximately 20, 30, 40 and 54
* **Sex**
    * has an almost equal split between Male and Female, with Male occurring slightly more often
* **BMI**
    * has an approximately normal distribution with a peak at about 30
* **Children**
    * has a skewed right distribution with a peak at 0
* **Smoker**
    * has a large split between smokers and non smokers, with a large majority of the beneficiaries being non-smokers
* **Region**
    * has an almost equal split between the 4 regions, with slightly more beneficiaries being from the southeast
* **Charges**
    * has a skewed right distribution with a peak just bellow $10,000